<ion-header translucent="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/teleconsultas"></ion-back-button>
    </ion-buttons>
    <ion-title>Detalle teleconsulta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen="true" class="ion-padding">
  <ion-progress-bar *ngIf="loading" type="indeterminate"></ion-progress-bar>

  <ng-container *ngIf="!loading && item; else notFound">
    <ion-card class="card">
      <ion-card-header>
        <ion-card-title>
          {{ item.date }} Â· {{ item.time }}
        </ion-card-title>

        <ion-card-subtitle>
          Modalidad: <b>{{ item.mode || '-' }}</b>
          <span class="dot">Â·</span>

          <ion-badge [color]="statusColor(item.status)">
            {{ statusLabel(item.status) }}
          </ion-badge>
        </ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <ion-list lines="none">
          <ion-item>
            <ion-label>
              <h3>Motivo</h3>
              <p>{{ item.reason || '-' }}</p>
            </ion-label>
          </ion-item>

          <ion-item>
            <ion-label>
              <h3>Observaciones</h3>
              <p>{{ item.notes || '-' }}</p>
            </ion-label>
          </ion-item>

          <ion-item>
            <ion-label>
              <h3>Correo</h3>
              <p>{{ item.email || '-' }}</p>
            </ion-label>
          </ion-item>
        </ion-list>

        <!-- Acciones segÃºn estado -->
        <ng-container *ngIf="item.status !== 'confirmed' && item.status !== 'cancelled'; else doneBlock">
          <ion-button expand="block" class="ion-margin-top" (click)="confirm()">
            Confirmar teleconsulta
          </ion-button>

          <ion-button expand="block" fill="outline" color="danger" (click)="cancel()">
            Cancelar
          </ion-button>
        </ng-container>

        <ng-template #doneBlock>
          <ion-button
            expand="block"
            [color]="statusColor(item.status)"
            disabled="true"
            class="ion-margin-top"
          >
            {{ item.status === 'confirmed' ? 'âœ… Confirmada' : 'ðŸš« Cancelada' }}
          </ion-button>
        </ng-template>

        <ion-button expand="block" fill="clear" color="medium" (click)="remove()">
          Eliminar agendamiento
        </ion-button>
      </ion-card-content>
    </ion-card>
  </ng-container>

  <ng-template #notFound>
    <ion-card>
      <ion-card-header>
        <ion-card-title>No encontrado</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        No se encontrÃ³ el agendamiento. Vuelve a la lista e intenta nuevamente.
      </ion-card-content>
    </ion-card>
  </ng-template>
</ion-content>
